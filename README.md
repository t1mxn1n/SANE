# SANE

**Нейроэволюционный алгоритм SANE** (Symbiotic, Adaptive Neuro-Evolution) 
является методом обучения искусственных нейронных сетей, который использует 
принципы эволюции для оптимизации архитектуры и параметров сети. Этот метод был 
предложен для улучшения производительности нейронных сетей путем использования 
генетических алгоритмов и принципа симбиоза. 

Основные аспекты **SANE** включают в себя:

1. **Симбиотическая эволюция:** В отличие от традиционных подходов, где эволюционирует вся нейронная сеть как единое целое, в SANE эволюционируют отдельные нейроны. Каждый нейрон представлен отдельным геномом, который содержит информацию о его весах и связях с другими нейронами.
2. **Популяция нейронов:** В SANE поддерживается популяция нейронов, каждый из которых оценивается на основе его вклада в производительность всей сети. Таким образом, вместо одной сети, имеющей единую оценку, оцениваются отдельные нейроны.
3. **Формирование сетей:** Для выполнения задач формируются сети из нейронов, отобранных из общей популяции. Эти сети оцениваются, и на основе их производительности оцениваются отдельные нейроны, участвующие в их составлении.
4. **Адаптивность:** Процесс эволюции адаптивен, так как постоянно происходит оценка и переоценка нейронов на основе их эффективности в различных комбинациях, что способствует улучшению общей производительности сети.

Основная идея SANE заключается в том, что раздельная эволюция нейронов позволяет 
лучше исследовать пространство возможных архитектур нейронной сети и находить 
более эффективные решения по сравнению с методами, эволюционирующими всю сеть целиком.

---

## Требования к запуску программы:

1. Python версии 3.11.*
2. Установленный драйвер **graphviz** (https://graphviz.org/download/) для построения топологии НС, с добавлением в PATH (важно!)

## Запуск программы

1. Склонировать репозиторий `git clone https://github.com/t1mxn1n/SANE.git`
2. Перейти в дирректорию проекта
3. Настроить переменное окружение (желательно)

```
>>> python -m venv venv
>>> .venv\Script\activate
```
4. Установить необходимые зависимости `pip install -r requirements.txt`
5. Запуск консольной версии приложения `python main.py`
6. Запуск GUI версии `python gui_app.py`

### Настройка гиперпараметров

1. Для консольной версии производится в файле `main.py`

```python
hyperparameters_default = {
    "dataset": "iris",  # доступны iris, wine, glass
    "population_size": 2000,  # размер популяции
    "hidden_neurons": 30,  # нейроны скрытого слоя
    "epoch": 500,  # максимальное число эпох обучения
    "neuron_connections": 5,  # кол-во связей у нейрона скрытого слоя
    "epoch_with_no_progress": 10,  # остановка алгоритма без обучения
    "freq_update_topology": 5  # обновление топологий НС
}
```

2. Для GUI версии производится вводом параметров перед запуском.

### Результат работы

1. Для консольной версии:

> Изображения топологий хранятся в папке `temp/graph/img_pil/*.png`, где `*` - номер эпохи

> График с метриками функции потерь и точности хранится в папке `temp/graph/metrics_result_plot`

> Лучшая модель НС, полученная при НЭ алгоритме находится в папке `models/*_model.npy`, где `*` - название датасета

2. Для GUI версии:

> Топология отображается с заданной частотой, а график доступен после завершения работы НЭ алгоритма.
